<script src="../../bower_components/jquery/dist/jquery.min.js"></script>
<script>
 /* global TaaabsBehaviors:true */
 /* exported TaaabsBehaviors */

 var TaaabsBehaviors = TaaabsBehaviors || {};

 /**
  * @demo no demo availaible yet
  * @polymerBehavior
  */
 TaaabsBehaviors.Stylesheet = {
   properties: {
     mode: {
       type: String
     },
     urlFileStylesheet: {
         type: String,
         value: 'setting/stylesheet.json'
       }
   },
   _getMode: function (traceURI){
     var mode ;
     if (localStorage["stylesheetTaabs"]){
        if (JSON.parse (localStorage.getItem("stylesheetTaabs")).indexOf(traceURI)== -1){
          mode ="R";
        }
        else{
           mode = "L";
        }

     }
     else mode ="R";
     return mode;
   },


   _getStylesheet : function(traceURI) {
     if (traceURI) {
       var mode = this._getMode(traceURI) ;
     }
     else mode = "R";

     if (mode === "R"){
       $.ajax({
        url:this.urlFileStylesheet,
        async: false,
        success:function(data) {
           result = data.ObselType;
        }
     });

      }
      else {
          result = JSON.parse(localStorage.getItem("stylesheetTaabs."+traceURI)).ObselType
      }

      return result;
    },
   _PutStylesheet: function(traceURI, objStyle) {
     if (localStorage["stylesheetTaabs"]){
       // add URI Trace to array
       if (JSON.parse (localStorage.getItem("stylesheetTaabs")).indexOf(traceURI)== -1){
         var arrayTraceUri =  JSON.parse (localStorage.getItem("stylesheetTaabs"));
         arrayTraceUri.push (traceURI);
         localStorage.setItem("stylesheetTaabs",JSON.stringify(arrayTraceUri));
         localStorage.setItem("stylesheetTaabs."+traceURI,JSON.stringify(objStyle));
       }

     }
     else {
       var arrayTraceUri = [];
       arrayTraceUri.push (traceURI);
       localStorage.setItem("stylesheetTaabs",JSON.stringify(arrayTraceUri));
       localStorage.setItem("stylesheetTaabs."+traceURI,JSON.stringify(objStyle));

     }

   }
 };
</script>
