
<dom-module id="taaabs-base">
  <style>
    :host {
      display: block;
    }
  </style>

  <template>
    <h2> Interface Base </h2>
    <div>{{baseSel.id}}</div>
    <div id="base-url">{{basesel.id}}</div>
    <div id="base-label">{{basesel.label}}</div>
    <div id="trace-list">  </div>
    <div id="model-list">  </div>
  </template>

  <script>
    /* global Polymer, Samotraces */

    Polymer({
      is: 'taaabs-base',
      properties: {
        base: {
          type: Object,
          notify: true,
          reflectToAttribute: true,
          value: function() { return {}; },
          observer: '_baseselChanged'
        },
        tracesel: {
          type: Object,
          notify: true,
          reflectToAttribute: true,
          value: function() { return {}; }
        },
        modelsel: {
          type: Object,
          notify: true,
          reflectToAttribute: true,
          value: function() { return {}; }
        }
      },
      _listTrace: function() {
        var BaseButton = this.$['trace-list'].querySelectorAll('.trace');
        for (var i = 0; i < BaseButton.length; i++) {
          BaseButton[i].onclick = this._clickTrace.bind(this);
        }
      },
      _listModel: function(){
        var BaseButton = this.$['model-list'].querySelectorAll('.model');
        for (var i = 0; i < BaseButton.length; i++) {
          BaseButton[i].onclick = this._clickModel.bind(this);
        }
      },
      _clickTrace: function(event) {
        var traceURL = this.base.id + event.srcElement.innerText;
        this.tracesel = new Samotraces.Ktbs.Trace(traceURL);
      },
      _clickModel: function(event) {
        var modelURL = this.base.id + event.srcElement.innerText;
        this.modelsel = new Samotraces.Ktbs.Model(modelURL);
      },
      _baseselChanged: function(newValue) {
        this.$['trace-list'].innerHTML = '';
        this.$['model-list'].innerHTML = '';
        var listTracewidget = new Samotraces.Ui.Widgets.Ktbs.ListTracesInBases(this.$['trace-list'], newValue, '');
        var listModelwidget = new Samotraces.Ui.Widgets.Ktbs.ListModelInBases(this.$['model-list'], newValue, '');
        listTracewidget.on('ListTrace', this._listTrace.bind(this));
        listModelwidget.on('ListModel', this._listModel.bind(this));
      }
    });
  </script>
</dom-module>
