<link rel="import" href="../../bower_components/polymer/polymer.html"/>

<dom-module id="taaabs-ktbs">
  <template>
    <h2 style="margin-left: 20%;">Interface KTBS</h2>
    <div id="ktbs-url"></div>
    <div id="list-base"></div>
  </template>

  <script src="../../bower_components/samotracesjs/src/UI/Widgets/ListBases.js"></script>
  <script src="../../bower_components/samotracesjs/src/core/KTBS.Base.js"></script>

  <script>
    /* global Polymer, Samotraces */

    Polymer({
      is: "taaabs-ktbs",
      properties: {
        basesel:{
          type: Object,
          notify: true,
          reflectToAttribute: true,
          value: function() {
            return {}; }
        },
        srcKtbs:{
          type: String,
          value: ''
        }
      },
      clickBase: function(event) {
        var BaseURL = this.ktbs.id + event.srcElement.innerText;
        this.basesel = new Samotraces.KTBS.Base(BaseURL);
      },
      listBaseCallback: function() {
        var BaseButton = this.$["list-base"].querySelectorAll('.base');
        for (var i = 0; i < BaseButton.length; i++) {
          BaseButton[i].onclick = this.clickBase.bind(this);
        }
      },
      ready: function() {
        this.ktbs = new Samotraces.KTBS(this.srcKtbs);
        this.$["ktbs-url"].appendChild(document.createTextNode("ID : " + this.ktbs.id));
        var ListBasewidget = new Samotraces.UI.Widgets.ktbs.ListBases (this.$["list-base"], this.ktbs, "");
        ListBasewidget.on("ListBase", this.listBaseCallback.bind(this));
      }
    });
  </script>
</dom-module>
