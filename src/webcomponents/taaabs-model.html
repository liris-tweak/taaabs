
<link rel="import" href="../../demo/bower_components/polymer/polymer.html"/>
<dom-module id="taaabs-base">
  <template>
    <h2 style="margin-left: 50%;"> Interface Base </h2>
    <div>{{baseSel.id}}</div>
    <div id= "URL_Base">{{basesel.id}}</div>
    <div id= "Label_Base">{{basesel.label}}</div>
    <h4> Liste des traces </h4>
    <div id="ListTraces">  </div>
    <h4> Liste des mod√®les </h4>
    <div id="ListModel">  </div>
  </template>
  <script src="../Widgets/ListTracesInBases.js"></script>
  <script src="../Widgets/ListModelInBases.js"></script>
  <script src="../Object/KTBS.Trace.js"></script>
  <script src="../Object/KTBS.Model.js"></script>
  <script>
  Polymer({
    is: "taaabs-base",
    properties: {
      basesel: {
        type: Object,
        notify: true,
        reflectToAttribute: true,
        value: function() { return {}; },
        observer: '_baseselChanged'
      },
      tracesel: {
        type: Object,
        notify: true,
        reflectToAttribute: true,
        value: function() { return {}; },
        observer: '_traceselChanged'
      },
      modelsel: {
        type: Object,
        notify: true,
        reflectToAttribute: true,
        value: function() { return {}; },
        observer: '_modelselChanged'
      },
    },

    _baseselChanged: function(newValue, oldValue) {
      PolyBase.$.ListTraces.innerHTML="";
      PolyBase.$.ListModel.innerHTML="";
      ListTracewidget = new Samotraces.UI.Widgets.ktbs.ListTracesInBases (PolyBase.$.ListTraces,newValue,'');
      ListModelwidget = new Samotraces.UI.Widgets.ktbs.ListModelInBases (PolyBase.$.ListModel,newValue,'');

      ListTracewidget.on("ListTrace",function(){
        var BaseButton = PolyBase.$.ListTraces.querySelectorAll('.trace')
        for (var i = 0; i < BaseButton.length; i++) {BaseButton[i].onclick = PolyBase.ClickTrace};
      })

      ListModelwidget.on("ListModel",function(){
        var BaseButton = PolyBase.$.ListModel.querySelectorAll('.model')
        for (var i = 0; i < BaseButton.length; i++) {BaseButton[i].onclick = PolyBase.ClickModel};
      })
    },

    ClickTrace: function(event) {
      TraceURL = PolyBase.basesel.id+event.srcElement.innerText;
      PolyBase.tracesel =  new Samotraces.KTBS.Trace(TraceURL);
    },

    ClickModel: function(event) {
      ModelURL = PolyBase.basesel.id+event.srcElement.innerText;
      PolyBase.modelsel =  new Samotraces.KTBS.Model(ModelURL);
    },
    ready: function() {
      PolyBase = this;
    }
  });
  </script>
</dom-module>
