<link rel="import" href="../../bower_components/polymer/polymer.html"/>

<dom-module id="taaabs-model">
  <template>
    <h2 style="margin-left: 50%;"> Interface Base </h2>
    <div>{{baseSel.id}}</div>
    <div id= "base-url">{{basesel.id}}</div>
    <div id= "base-label">{{basesel.label}}</div>
    <h4> Liste des traces </h4>
    <div id="trace-list"></div>
    <h4> Liste des mod√®les </h4>
    <div id="model-list"></div>
  </template>

  <script>
    /* global Polymer, Samotraces */

    Polymer({
      is: "taaabs-model",
      properties: {
        basesel: {
          type: Object,
          notify: true,
          reflectToAttribute: true,
          value: function() { return {}; },
          observer: '_baseselChanged'
        },
        tracesel: {
          type: Object,
          notify: true,
          reflectToAttribute: true,
          value: function() { return {}; },
          observer: '_traceselChanged'
        },
        modelsel: {
          type: Object,
          notify: true,
          reflectToAttribute: true,
          value: function() { return {}; },
          observer: '_modelselChanged'
        }
      },
      _listTrace: function() {
        var BaseButton = this.$["trace-list"].querySelectorAll('.trace');
        for (var i = 0; i < BaseButton.length; i++) {
          BaseButton[i].onclick = this._clickTrace.bind(this);
        }
      },
      _listModel: function() {
        var BaseButton = this.$["model-list"].querySelectorAll('.model');
        for (var i = 0; i < BaseButton.length; i++) {
          BaseButton[i].onclick = this._clickModel.bind(this);
        }
      },
      _clickTrace: function(event) {
        var traceURL = this.basesel.id + event.srcElement.innerText;
        new Samotraces.Ktbs.Trace(traceURL);
      },
      _clickModel: function(event) {
        var ModelURL = this.basesel.id + event.srcElement.innerText;
        new Samotraces.Ktbs.Model(ModelURL); // we dont use it ?
      },
      _baseselChanged: function(newValue) {
        this.$["trace-list"].innerHTML="";
        this.$["model-list"].innerHTML="";
        var listTracewidget = new Samotraces.Ui.Widgets.Ktbs.ListTracesInBases(this.$["trace-list"], newValue, '');
        var listModelwidget = new Samotraces.Ui.Widgets.Ktbs.ListModelInBases(this.$["model-list"], newValue, '');
        listTracewidget.on("ListTrace", this._listTrace.bind(this));
        listModelwidget.on("ListModel", this._listModel.bind(this));
      }
    });
  </script>
</dom-module>
